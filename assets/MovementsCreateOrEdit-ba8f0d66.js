import{q as f,l as C,e as h,G as x,o as c,c as v,d as e,s as d,N as k,h as n,O as b,t as y,P as S,F as M,k as w,A as V,B as $,f as U,b as B,i as D}from"./index-1714ad95.js";import{s as G,u as O}from"./useMovements-e0d777a5.js";const E=m=>{const i=f([]),l=f(!1),a=C({number:"",amount:0,balance:0,budget:0,category_id:0,concept:"",created_at:new Date().toISOString(),moment:new Date().toISOString(),id:0,movement_type:!1});return m&&m.movement&&(a.number=m.movement.number,a.amount=m.movement.amount,a.balance=m.movement.balance,a.budget=m.movement.budget,a.category_id=m.movement.category_id,a.concept=m.movement.concept,a.created_at=m.movement.created_at,a.moment=m.movement.moment,a.id=m.movement.id,a.movement_type=m.movement.movement_type),{categories:i,form:a,pending:l,getCategories:async(p=!1)=>{l.value=!0;const{data:r}=await G.from("categories").select("id, name").eq("type",p);i.value=r,l.value=!1}}},F=["onSubmit"],N={class:"grid lg:grid-cols-2 gap-4"},q={class:"block"},I=e("label",{class:"block"},"Movement",-1),R={class:"inline mr-2"},j=e("label",{class:"ml-2"},"Income",-1),A={class:"inline"},L=e("label",{class:"ml-2"},"Expenses",-1),P={class:"block mr-2"},T=e("label",{class:"block mb-2"},"Number",-1),z={class:"border border-gray-300 pl-2 py-2 bg-gray-100 text-gray-400",style:{"padding-right":"69%"}},H={class:"block"},J=e("label",null,"Date",-1),K={class:"block"},Q=e("label",null,"Select a frequency",-1),W=["value","selected"],X={class:"block"},Y=e("label",{class:"mr-2"},"Concept",-1),Z={class:"block"},ee=e("label",{class:"mr-2"},"Budget",-1),te={class:"block"},ne=e("label",{class:"mr-2"},"Amount",-1),oe=["text","isDisabled"],se=h({__name:"FormMovement",props:{movement:{},pending:{type:Boolean}},emits:["submit"],setup(m,{emit:i}){const l=m,{categories:a,form:t,pending:p,getCategories:r}=E(l);x(async()=>{l&&l.movement?await r(l.movement.movement_type):await r(!1)});const _=u=>{t.category_id=0,r(u)},g=()=>{i("submit",{number:t.number,moment:t.moment,category_id:t.category_id,concept:t.concept,budget:t.budget,amount:t.amount,movement_type:t.movement_type},l.movement?l.movement.id:void 0)};return(u,o)=>(c(),v("form",{onSubmit:V(g,["prevent"])},[e("div",N,[e("div",q,[I,e("div",R,[d(e("input",{type:"radio","onUpdate:modelValue":o[0]||(o[0]=s=>n(t).movement_type=s),value:!0,name:"type",onClick:o[1]||(o[1]=s=>_(!0))},null,512),[[k,n(t).movement_type]]),j]),e("div",A,[d(e("input",{type:"radio","onUpdate:modelValue":o[2]||(o[2]=s=>n(t).movement_type=s),value:!1,name:"type",onClick:o[3]||(o[3]=s=>_(!1))},null,512),[[k,n(t).movement_type]]),L])]),e("div",P,[d(e("input",{type:"hidden","onUpdate:modelValue":o[4]||(o[4]=s=>n(t).id=s)},null,512),[[b,n(t).id]]),T,e("span",z,y(n(t).number),1)]),e("div",H,[J,d(e("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=s=>n(t).moment=s)},null,512),[[b,n(t).moment]])]),e("div",K,[Q,d(e("select",{"onUpdate:modelValue":o[6]||(o[6]=s=>n(t).category_id=s)},[(c(!0),v(M,null,w(n(a),s=>(c(),v("option",{value:s.id,key:s.id,selected:s.id===n(t).category_id},y(s.name),9,W))),128))],512),[[S,n(t).category_id]])]),e("div",X,[Y,d(e("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=s=>n(t).concept=s)},null,512),[[b,n(t).concept]])]),e("div",Z,[ee,d(e("input",{type:"text","onUpdate:modelValue":o[8]||(o[8]=s=>n(t).budget=s)},null,512),[[b,n(t).budget]])]),e("div",te,[ne,d(e("input",{type:"text","onUpdate:modelValue":o[9]||(o[9]=s=>n(t).amount=s)},null,512),[[b,n(t).amount]])])]),e("button",{class:"btn btn-primary mt-5 justify-self-start",type:"submit",text:u.pending?"Guardando...":"Guardar",isDisabled:u.pending,onSubmit:o[10]||(o[10]=s=>g())},y(l.pending?"Guardando...":"Guardar"),41,oe)],40,F))}}),ae={class:"container row col-md-6 mx-auto w-full"},me={key:0,class:"text-2xl",align:"center"},le={key:1,class:"text-2xl",align:"center"},ie={class:"flex space-x-2 my-2"},ue=h({__name:"MovementsCreateOrEdit",props:{id:{}},setup(m){const i=m,l=$(),{movement:a,pending:t,getMovement:p,submit:r}=O();i&&i.id&&x(async()=>{await p(i.id)});const _=U(()=>i.id&&a.value&&Object.keys(a.value).length>0||i.id===void 0);return(g,u)=>(c(),v("div",ae,[n(t)?(c(),v("h1",me,"Loading...")):(c(),v("h1",le,y(g.$props.id?"Edit":"Create")+" Movement ",1)),e("div",ie,[e("button",{class:"btn btn-primary mb-4",onClick:u[0]||(u[0]=o=>n(l).push({path:"/movements"}))}," See all movements ")]),_.value?(c(),B(se,{key:2,movement:n(a),pending:n(t),onSubmit:n(r)},null,8,["movement","pending","onSubmit"])):D("",!0)]))}});export{ue as default};
